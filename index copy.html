<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#3B82F6">
<link rel="icon" type="image/png" href="icon.png">


    <title>Stand Out</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    <!-- Stylesheet will be injected in Message 2 -->
    <style>
        /* =========================================================
   CORE LAYOUT & BODY
========================================================= */
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background: #0a0a0a;
            color: #fff;
        }

        header {
            text-align: center;
            padding: 2rem;
            background: #001f3f;
        }

        header h1 {
            margin: 0;
            font-size: 2.5rem;
            color: #3B82F6;
        }
/* ===========================
   TOP NAVBAR (Fully fixed + responsive)
=========================== */
.top-navbar {
    width: 100%;
    height: 60px;
    background: #111827;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 9999;

    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;

    padding: 0 16px;

    /* border-bottom: 2px solid #1f2937; */

    /* Prevent wrapping */
    flex-wrap: nowrap;
    white-space: nowrap;
}

.nav-left {
    font-size: 1.5rem;
    font-weight: 700;
    color: #3B82F6;
}

.nav-right {
    display: flex;
    align-items: center;
    flex-shrink: 0; /* prevents shrinking/wrapping */
}

.nav-right .nav-img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    margin-right: 2rem;
}

/* Prevent content going under navbar */
section {
    margin-top: 70px !important;
}


        /* =========================================================
   BOTTOM NAVIGATION
========================================================= */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 55px;
            background: #1f2937;
            display: flex;
            justify-content: space-evenly;
            flex-direction: row;
            align-items: center;
            border-top: 2px solid #111;
            z-index: 50;
        }

        .bottom-nav button {
            flex: 1;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 14px;
            height: 100%;
            cursor: pointer;
            transition: color 0.2s, transform 0.2s;
        }

        .bottom-nav button:hover {
            color: #3b82f6;
            transform: scale(1.05);
        }

        .bottom-nav button.active {
            color: #3b82f6;
            font-weight: bold;
        }


        /* =========================================================
   PAGE SECTIONS
========================================================= */
        section {
            display: none;
            padding: 1rem 1rem 0px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            height: calc(100vh - 55px - 50px);
            overflow-y: auto;
        }

        section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .hidden {
            display: none;
        }


        /* =========================================================
   FLOATING + ADD BUTTONS
========================================================= */
        .plus-btn {
            position: fixed;
            bottom: 4.5rem;
            right: 1rem;
            z-index: 100;
            padding: 0.6rem 1.2rem;
            background: #3B82F6;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .plus-btn:hover {
            background: #2563EB;
            transform: scale(1.05);
        }

        .plus-btn2 {
            position: sticky;
            bottom: 0px;
            margin-top: 1rem;
            padding: 0.6rem 1.2rem;
            background: #3B82F6;
            border: none;
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }


        /* =========================================================
   LIST ITEMS (MISSIONS, SKILLS, GOALS)
========================================================= */
        ul {
            list-style-type: none;
            padding: 0;
        }

        ul li {
            background: #1f2937;
            margin: 0.5rem 0;
            padding: 1rem;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.4s ease, opacity 0.4s ease;
        }

        ul li.remove {
            transform: translateX(100%);
            opacity: 0;
            display: none;
        }

        .skill,
        .goal {
            background: #1f2937;
            margin: 0.5rem 0;
            padding: 0.7rem;
            border-radius: 6px;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            cursor: pointer;
            display: none;
        }

        .skill.show,
        .goal.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }


        /* =========================================================
   PROGRESS BARS
========================================================= */
        .progress {
            background: #333;
            border-radius: 4px;
            overflow: hidden;
            height: 10px;
            margin-top: 5px;
        }

        .progress-bar {
            height: 10px;
            background: #3B82F6;
            width: 0%;
            transition: width 0.5s ease;
        }


        /* =========================================================
   BUTTONS (COMPLETE, REMOVE, DANGER)
========================================================= */
        .complete-btn {
            background: transparent;
            border: none;
            color: #3B82F6;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .complete-btn:hover {
            transform: scale(1.2);
            color: #2563EB;
        }

        .remove-btn,
        .remove-btn2 {
            background: transparent;
            border: none;
            color: #e63946;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin-right: 1rem;
        }

        .remove-btn:hover,
        .remove-btn2:hover {
            transform: scale(1.2);
            color: #f87171;
        }



        .danger-btn {
            background: #e63946;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .danger-btn:hover {
            background: #d62828;
        }


        /* =========================================================
   COUNTDOWN TIMER
========================================================= */
        .timer {
            font-size: 1.5rem;
            margin: 1rem 0;
        }


        /* =========================================================
   MODALS (ADD/EDIT, ALERT, CONFIRM)
========================================================= */
        .modal,
        .alert-modal,
        .confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal.active,
        .alert-modal.active,
        .confirm-modal.active {
            display: flex;
        }

        .modal-content,
        .alert-content,
        .confirm-content {
            background: #111827;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 400px;
            animation: fadeIn 0.3s ease;
        }

        .modal-content h3,
        .alert-content h3,
        .confirm-content h3 {
            margin-top: 0;
            color: #3B82F6;
        }

        .modal-content input,
        .modal-content select {
            width: 100%;
            padding: 0.7rem;
            margin: 0.5rem 0 1rem;
            border-radius: 6px;
            border: none;
            background: #1f2937;
            color: white;
            outline: none;
        }

        .modal-content button,
        .alert-content button,
        .confirm-content button {
            padding: 0.6rem 1rem;
            border: none;
            border-radius: 6px;
            background: #3B82F6;
            color: white;
            cursor: pointer;
            margin-right: 0.5rem;
        }


        /* =========================================================
   POPUPS (MISSION COMPLETE)
========================================================= */
        .popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.75);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .popup-content {
            background: #121212;
            color: #e0e0e0;
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            width: 85%;
            max-width: 320px;
            box-shadow: 0 0 25px #3B82F6;
            transform: scale(0.7);
            opacity: 0;
            animation: popIn 0.4s ease forwards;
        }

        .popup-content h2 {
            margin-bottom: 10px;
            color: #3B82F6;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .popup-content p {
            margin: 8px 0;
            font-size: 15px;
            line-height: 1.4;
        }

        .popup-content button {
            margin-top: 15px;
            padding: 10px 20px;
            background: #3B82F6;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            color: #121212;
            transition: background 0.3s;
        }

        .overdue-badge {
            background: #e63946;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            white-space: nowrap;
            max-width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
        }


        /* =========================================================
   ACHIEVEMENT POPUP
========================================================= */
        .achievement-popup {
            position: fixed;
            top: 1rem;
            left: 50%;
            transform: translateX(-50%);
            background: #111827;
            color: #3B82F6;
            padding: 1rem 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 9999;
            text-align: center;
            font-weight: bold;
        }

        .achievement-tile {
            width: 120px;
            padding: 10px;
            background: #1f2937;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, background 0.3s;
        }

        .achievement-tile:hover {
            transform: scale(1.05);
            background: #111827;
        }

        .achievement-icon {
            font-size: 28px;
            margin-bottom: 5px;
            color: #3B82F6;
        }

        .locked .achievement-icon {
            color: #6b7280;
        }

        .achievement-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 3px;
            color: #fff;
        }

        .locked .achievement-title,
        .locked .achievement-desc {
            color: #6b7280;
        }

        .achievement-desc {
            font-size: 12px;
            color: #9ca3af;
        }

        .achievements-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: flex-start;
            padding: 1rem;
        }


        /* =========================================================
   ANIMATIONS
========================================================= */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes popIn {
            0% {
                transform: scale(0.7);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: scale(0.7);
                opacity: 0;
            }
        }


        /* =========================================================
   MEDIA QUERIES
========================================================= */
        @media (max-width: 768px) {
            nav {
                flex-direction: column;
            }

            nav button {
                width: 100%;
            }

            section {
                padding: 1rem;
            }

            .calendar {
                gap: 0.3rem;
            }

            .day {
                padding: 0.5rem;
            }
        }

        @media (max-width: 450px) {
            .bottom-nav {
                bottom: 0vh;
            }

            .plus-btn {
                bottom: 6.8rem;
            }
        }

        h5 a {
            text-decoration: none;
            color: #3B82F6;
        }

        .goal-subrow {
            display: flex;
            gap: 6px;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 6px;
        }

        .goal-deadline {
            font-size: 12px;
            opacity: 0.7;
            white-space: nowrap;
        }

        .timer-row {
            margin-top: 6px;
        }

        .timer-bar-container {
            width: 100%;
            height: 6px;
            background: #1f2937;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .timer-bar {
            height: 100%;
            width: 0%;
            background: #3b82f6;
            transition: width 0.3s linear;
        }

        .timer-text {
            font-size: 14px;
            opacity: 0.9;
        }
    </style>
</head>

<body>
<!-- ===========================
       Top Navbar
=========================== -->
<nav class="top-navbar">
    <div class="nav-left">Stand Out</div>
    <div class="nav-right">
        <img src="icon.jpeg" alt="Profile" class="nav-img">
    </div>
</nav>

    <!-- ===========================
       Bottom Navigation
  ============================ -->
    <nav class="bottom-nav">
        <button id="nav-missions" onclick="showPage('missions')">
            <span class="icon"></span><span class="label">Missions</span>
        </button>
        <button id="nav-skillset" onclick="showPage('skillset')">
            <span class="icon"></span><span class="label">Skillset</span>
        </button>
        <button id="nav-time" onclick="showPage('time')">
            <span class="icon"></span><span class="label">Time</span>
        </button>
        <button id="nav-goals" onclick="showPage('goals')">
            <span class="icon"></span><span class="label">Goals</span>
        </button>
        <button id="nav-account" onclick="showPage('account')">
            <span class="icon"></span><span class="label">Account</span>
        </button>
    </nav>


    <!-- ===========================
       Mission Completion Popup
  ============================ -->
    <div id="motivationPopup" class="popup">
        <div class="popup-content">
            <h2 id="popup-title">Mission Complete</h2>
            <p id="motivationQuote"></p>
            <p id="achievement"></p>
            <button onclick="closePopup()">Continue</button>
        </div>

        <audio id="popupSound" src="Complete.mp3" preload="auto"></audio>
    </div>


    <!-- ===========================
       Missions Section
  ============================ -->
    <section id="missions" class="active">
        <h2>Missions</h2>
        <p>Improvement Points: <span id="missionCounter">0</span></p>
        <ul id="mission-list"></ul>
    </section>

    <!-- Floating Add Button -->
    <button class="plus-btn" id="globalAddBtn" onclick="openModal('mission')">+ Add</button>


    <!-- ===========================
       Skillset Section
  ============================ -->
    <section id="skillset">
        <h2>Skillset</h2>
        <div id="skill-list"></div>
    </section>


    <!-- ===========================
       Goals Section
  ============================ -->
    <section id="goals">
        <h2>Goals</h2>
        <div id="goal-list"></div>
    </section>


    <!-- ===========================
       Time / Countdown Section
  ============================ -->
    <section id="time">
        <h2>Time</h2>
        <p>Countdowns: <span id="countdownCounter">0</span></p>
        <div id="countdown-list"></div>
    </section>


    <!-- ===========================
       Account Section
  ============================ -->
    <section id="account" class="hidden">
        <h2>Documentation</h2>

        <h5><a href="documentation.html">Stand Out Version 1.8</a></h5>
        <h5>Date of Documentation: 23 Dec 2025</h5>

        <h3>Achievements</h3>
        <div id="achievementsViewer" style="display: flex; flex-wrap: wrap; gap: 0.5rem;"></div>

        <h3>Reset Data</h3>
        <button onclick="customConfirm('Are you sure you want to reset all data?', resetData)" class="danger-btn">
            Reset My Data
        </button>
    </section>


    <!-- ===========================
       Modals (Add/Edit + Alert + Confirm)
  ============================ -->
    <div class="modal" id="modal">
        <div class="modal-content" id="modal-content"></div>
    </div>

    <div class="alert-modal" id="alertModal">
        <div class="alert-content">
            <h3 id="alertMsg"></h3>
            <button onclick="closeAlert()">OK</button>
        </div>
    </div>

    <div class="confirm-modal" id="confirmModal">
        <div class="confirm-content">
            <h3 id="confirmMsg"></h3>
            <button onclick="confirmYes()">Yes</button>
            <button onclick="confirmNo()">No</button>
        </div>
    </div>


    <!-- ===========================
       JavaScript (Message 3)
  ============================ -->
  <script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js")
    .then(() => console.log("Service Worker Registered"));
}
</script>

    <script>
        /* =========================================================
       1. GLOBAL VARIABLES + STORED DATA
    ========================================================= */
        let completedMissions = parseInt(localStorage.getItem("completedMissions")) || 0;
        let missionHistory = JSON.parse(localStorage.getItem("missionHistory")) || {};
        window.addEventListener("load", () => {
            checkMissedDeadlines();
        });


        document.getElementById("missionCounter").textContent = completedMissions;


        /* =========================================================
           2. ACHIEVEMENTS SYSTEM
        ========================================================= */

        // Achievement definitions
        const achievements = [
            { id: "mission1", title: "First Step", desc: "Complete your very first mission", unlocked: false },
            { id: "mission5", title: "On a Roll", desc: "Complete 5 missions", unlocked: false },
            { id: "mission10", title: "Mission Master", desc: "Complete 10 missions", unlocked: false },
            { id: "mission15", title: "Halfway Hero", desc: "Complete 15 missions", unlocked: false },
            { id: "mission20", title: "Goal Getter", desc: "Complete 20 missions", unlocked: false },
            { id: "mission25", title: "Silver Streak", desc: "Complete 25 missions", unlocked: false },
            { id: "mission30", title: "Mission Maestro", desc: "Complete 30 missions", unlocked: false },
            { id: "mission35", title: "Trailblazer", desc: "Complete 35 missions", unlocked: false },
            { id: "mission40", title: "Achievement Hunter", desc: "Complete 40 missions", unlocked: false },
            { id: "mission45", title: "Mission Veteran", desc: "Complete 45 missions", unlocked: false },
            { id: "mission50", title: "Legendary Milestone", desc: "Complete 50 missions", unlocked: false },
            { id: "mission55", title: "Mastermind", desc: "Complete 55 missions", unlocked: false },
            { id: "mission60", title: "Champion", desc: "Complete 60 missions", unlocked: false },
            { id: "mission65", title: "Pathfinder", desc: "Complete 65 missions", unlocked: false },
            { id: "mission70", title: "Mission Conqueror", desc: "Complete 70 missions", unlocked: false },
            { id: "mission75", title: "Epic Endeavor", desc: "Complete 75 missions", unlocked: false },
            { id: "mission80", title: "Trail Master", desc: "Complete 80 missions", unlocked: false },
            { id: "mission85", title: "Ultimate Achiever", desc: "Complete 85 missions", unlocked: false },
            { id: "mission90", title: "Hero of Tasks", desc: "Complete 90 missions", unlocked: false },
            { id: "mission95", title: "Task Titan", desc: "Complete 95 missions", unlocked: false },
            { id: "mission100", title: "Century Club", desc: "Complete 100 missions", unlocked: false },
            { id: "mission105", title: "Beyond Limits", desc: "Complete 105 missions", unlocked: false },
            { id: "mission110", title: "Relentless", desc: "Complete 110 missions", unlocked: false },
            { id: "mission115", title: "Sky High", desc: "Complete 115 missions", unlocked: false },
            { id: "mission120", title: "Goal Crusher", desc: "Complete 120 missions", unlocked: false },
            { id: "mission125", title: "Mission Marathoner", desc: "Complete 125 missions", unlocked: false },
            { id: "mission130", title: "Infinite Drive", desc: "Complete 130 missions", unlocked: false },
            { id: "mission135", title: "Peak Performer", desc: "Complete 135 missions", unlocked: false },
            { id: "mission140", title: "Legend in Making", desc: "Complete 140 missions", unlocked: false },
            { id: "mission145", title: "Champion of Tasks", desc: "Complete 145 missions", unlocked: false },
            { id: "mission150", title: "Task Legend", desc: "Complete 150 missions", unlocked: false },
            { id: "mission155", title: "Milestone Achiever", desc: "Complete 155 missions", unlocked: false },
            { id: "mission160", title: "Mission Icon", desc: "Complete 160 missions", unlocked: false },
            { id: "mission165", title: "Epic Journey", desc: "Complete 165 missions", unlocked: false },
            { id: "mission170", title: "Task Champion", desc: "Complete 170 missions", unlocked: false },
            { id: "mission175", title: "Master of Milestones", desc: "Complete 175 missions", unlocked: false },
            { id: "mission180", title: "Legendary Achiever", desc: "Complete 180 missions", unlocked: false },
            { id: "mission185", title: "Ultimate Victor", desc: "Complete 185 missions", unlocked: false },
            { id: "mission190", title: "Task Hero", desc: "Complete 190 missions", unlocked: false },
            { id: "mission195", title: "Mission Elite", desc: "Complete 195 missions", unlocked: false },
            { id: "mission200", title: "Two Hundred Triumphs", desc: "Complete 200 missions", unlocked: false },
            { id: "mission205", title: "Beyond Achievement", desc: "Complete 205 missions", unlocked: false },
            { id: "mission210", title: "Victory Streak", desc: "Complete 210 missions", unlocked: false },
            { id: "mission215", title: "Unstoppable", desc: "Complete 215 missions", unlocked: false },
            { id: "mission220", title: "Peak Achiever", desc: "Complete 220 missions", unlocked: false },
            { id: "mission225", title: "Mission Overlord", desc: "Complete 225 missions", unlocked: false },
            { id: "mission230", title: "Epic Victor", desc: "Complete 230 missions", unlocked: false },
            { id: "mission235", title: "Champion of Goals", desc: "Complete 235 missions", unlocked: false },
            { id: "mission240", title: "Task Mastermind", desc: "Complete 240 missions", unlocked: false },
            { id: "mission245", title: "Legendary Hero", desc: "Complete 245 missions", unlocked: false },
            { id: "mission250", title: "Ultimate Legend", desc: "Complete 250 missions", unlocked: false }
        ];

        // Load achievements from storage
        let achievementsData = JSON.parse(localStorage.getItem("achievements"));
        if (!achievementsData) {
            achievementsData = achievements;
            localStorage.setItem("achievements", JSON.stringify(achievements));
        }

        const quotes = [
            "Discipline is the bridge between goals and achievement.",
            "Consistency creates progress, progress creates success.",
            "Small steps every day lead to big results.",
            "Effort today becomes strength tomorrow.",
            "Stay focused, stay strong, keep moving forward.",
            "Success is the sum of small efforts repeated daily.",
            "Your only limit is your mind.",
            "Great things never come from comfort zones.",
            "Dream it. Believe it. Achieve it.",
            "Push yourself, because no one else is going to do it for you.",
            "The harder you work for something, the greater you’ll feel when you achieve it.",
            "Don’t stop when you’re tired. Stop when you’re done.",
            "Focus on progress, not perfection.",
            "Your future is created by what you do today, not tomorrow.",
            "Small progress is still progress.",
            "Motivation gets you started, habit keeps you going.",
            "Do something today that your future self will thank you for.",
            "Success doesn’t come from what you do occasionally, it comes from what you do consistently.",
            "Believe in yourself and all that you are.",
            "Take the risk or lose the chance."
        ];

        /* Render achievements in account page */
        function renderAchievements() {
            const container = document.getElementById("achievementsViewer");
            if (!container) return;

            container.innerHTML = "";

            const unlocked = achievementsData.filter(a => a.unlocked);
            const locked = achievementsData.filter(a => !a.unlocked).slice(0, 5);
            const displayList = [...unlocked, ...locked];

            displayList.forEach(ach => {
                const div = document.createElement("div");
                div.className = "achievement-tile" + (ach.unlocked ? "" : " locked");

                const icon = ach.unlocked
                    ? '<i class="fas fa-trophy"></i>'
                    : '<i class="fas fa-lock"></i>';

                div.innerHTML = `
      <div class="achievement-icon">${icon}</div>
      <div class="achievement-title">${ach.title}</div>
      <div class="achievement-desc">${ach.desc}</div>
    `;

                container.appendChild(div);
            });
        }

        /* Unlock an achievement */
        function unlockAchievement(id) {
            const ach = achievementsData.find(a => a.id === id);
            if (ach && !ach.unlocked) {
                ach.unlocked = true;
                localStorage.setItem("achievements", JSON.stringify(achievementsData));
                showAchievementPopup(ach.title, ach.desc);
                renderAchievements();
            }
        }

        function showAchievementPopup(title, desc) {
            window.isAchievementPlaying = true;

            const popup = document.createElement("div");
            popup.className = "achievement-popup";
            popup.innerHTML = `<h3>${title}</h3><p>${desc}</p>`;
            document.body.appendChild(popup);

            const audio = new Audio("Achievements.mp3");
            audio.volume = 0.5;
            audio.play().catch(() => { });

            audio.onended = () => { window.isAchievementPlaying = false; };

            popup.style.opacity = 0;
            popup.style.transform = "translateY(-50px)";
            setTimeout(() => {
                popup.style.transition = "all 0.5s ease";
                popup.style.opacity = 1;
                popup.style.transform = "translateY(0)";
            }, 10);

            setTimeout(() => {
                popup.style.opacity = 0;
                popup.style.transform = "translateY(-50px)";
                setTimeout(() => popup.remove(), 500);
            }, 3000);
        }


        /* =========================================================
           3. NAVIGATION SYSTEM
        ========================================================= */
        function showPage(pageId) {
            document.querySelectorAll("section").forEach(sec =>
                sec.classList.remove("active")
            );

            const page = document.getElementById(pageId);
            if (page) page.classList.add("active");

            document.querySelectorAll(".bottom-nav > button")
                .forEach(b => b.classList.remove("active"));

            const btn = document.getElementById("nav-" + pageId);
            if (btn) btn.classList.add("active");

            updatePlusBtn(pageId);

            if (pageId === "account") renderAchievements();
        }

        function updatePlusBtn(pageId) {
            const btn = document.getElementById("globalAddBtn");
            if (!btn) return;

            if (pageId === "missions") {
                btn.setAttribute("onclick", "openModal('mission')");
                btn.style.display = "block";
            } else if (pageId === "skillset") {
                btn.setAttribute("onclick", "openModal('skill')");
                btn.style.display = "block";
            } else if (pageId === "goals") {
                btn.setAttribute("onclick", "openModal('goal')");
                btn.style.display = "block";
            } else if (pageId === "time") {
                btn.setAttribute("onclick", "openModal('multi-time')");
                btn.style.display = "block";
            } else {
                btn.style.display = "none";
            }
        }


        /* =========================================================
           4. MODALS (ADD / EDIT / ALERT / CONFIRM)
        ========================================================= */
        function openModal(type, skillDiv = null) {
            const modal = document.getElementById("modal");
            const content = document.getElementById("modal-content");

            modal.classList.add("active");

            // ---- Add Mission ----
            if (type === 'mission') {
                content.innerHTML = `
      <h3>Add Mission</h3>
      <input id="missionInput" placeholder="Enter mission">
      <label>Deadline</label>
      <input id="missionDeadline" type="datetime-local">
      <button onclick="addMission()">Add</button>
      <button onclick="closeModal()">Cancel</button>
    `;
            }

            // ---- Edit Mission ----
            if (type === "edit-mission" && skillDiv) {
                const oldText = skillDiv.querySelector(".mission-text").textContent;
                const oldDeadline = skillDiv.dataset.deadline || "";

                content.innerHTML = `
      <h3>Edit Mission</h3>
      <input id="editMissionInput" value="${oldText}">
      <label>Deadline</label>
      <input id="editMissionDeadline" type="datetime-local" value="${oldDeadline}">
      <button onclick="updateMission()">Update</button>
      <button onclick="deleteMission()">Delete</button>
      <button onclick="closeModal()">Cancel</button>
    `;

                window.missionBeingEdited = skillDiv;
            }

            // ---- Add Skill ----
            if (type === "skill") {
                content.innerHTML = `
      <h3>Add Skill</h3>
      <input id="skillInput" placeholder="Skill name">
      <input id="progressInput" type="number" placeholder="Progress % (0-100)">
      <button onclick="addSkill()">Add</button>
      <button onclick="closeModal()">Cancel</button>
    `;
            }

            // ---- Edit Skill ----
            if (type === "edit-skill" && skillDiv) {
                const skillName = skillDiv.querySelector("strong").textContent;
                const currentProgress =
                    skillDiv.querySelector(".progress-bar").style.width.replace("%", "");

                content.innerHTML = `
      <h3>Edit ${skillName}</h3>
      <input id="editProgressInput" type="number" value="${currentProgress}">
      <button onclick="updateSkillProgress('${skillName}')">Update</button>
      <button onclick="deleteSkill('${skillName}')">Delete</button>
      <button onclick="closeModal()">Cancel</button>
    `;
            }

            // ---- Add Goal ----
            if (type === "goal") {
                content.innerHTML = `
    <h3>Add Goal</h3>
    <input id="goalInput" placeholder="Goal">

    <label>Priority</label>
    <select id="priorityInput">
      <option>High</option>
      <option>Medium</option>
      <option>Low</option>
    </select>

    <label>Deadline</label>
    <input id="goalDeadline" type="datetime-local">

    <button onclick="addGoal()">Add</button>
    <button onclick="closeModal()">Cancel</button>
  `;
            }


            // ---- Add Countdown (FIXED) ----
            if (type === "multi-time") {
                content.innerHTML = `
      <h3>Add Countdown</h3>
<input id="countdownTitle" placeholder="Title">
<input id="countdownDateTime" type="datetime-local">

<button onclick="addCountdown()">Add</button>
<button onclick="closeModal()">Cancel</button>

    `;
            }
        }

        // ---- FIXED: closeModal OUTSIDE openModal ----
        function closeModal() {
            document.getElementById("modal").classList.remove("active");
        }


        /* Alerts */
        function customAlert(msg) {
            document.getElementById("alertMsg").textContent = msg;
            document.getElementById("alertModal").classList.add("active");
        }

        function closeAlert() {
            document.getElementById("alertModal").classList.remove("active");
        }

        /* Confirm */
        let confirmCallback = null;

        function customConfirm(msg, callback) {
            confirmCallback = callback;
            document.getElementById("confirmMsg").textContent = msg;
            document.getElementById("confirmModal").classList.add("active");
        }

        function confirmYes() {
            if (confirmCallback) confirmCallback();
            document.getElementById("confirmModal").classList.remove("active");
        }

        function confirmNo() {
            document.getElementById("confirmModal").classList.remove("active");
        }


        /* =========================================================
           5. MISSIONS MODULE
        ========================================================= */
        const missionMilestones = [1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50];

        function addMission() {
            const val = document.getElementById('missionInput').value;
            const deadline = document.getElementById('missionDeadline').value;

            if (val) {
                const li = document.createElement('li');
                li.dataset.deadline = deadline;

                li.innerHTML = `
  <span class="mission-text">${val}</span>
  <span class="deadlineDisplay"></span>
  <span class="overdueMark"></span>
  <button class="complete-btn" onclick="completeMission(this)">✔</button>
`;

                li.addEventListener("click", (e) => {
                    if (e.target.classList.contains("complete-btn")) return; // ignore complete click
                    openModal("edit-mission", li);
                });


                // Show deadline date
                if (deadline) {
                    const d = new Date(deadline);
                    const dateString = d.toLocaleDateString([], { day: 'numeric', month: 'short' });
                    const timeString = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

                    li.querySelector(".deadlineDisplay").textContent = `${dateString}, ${timeString}`;
                }


                document.getElementById('mission-list').appendChild(li);
                saveData();
            }
            closeModal();
        }

        function checkMissedDeadlines() {
            const missions = document.querySelectorAll("#mission-list li");
            const now = new Date().getTime();

            missions.forEach(li => {
                const deadline = li.dataset.deadline;
                if (!deadline) return;

                const deadlineTime = new Date(deadline).getTime();

                // If overdue
                if (now > deadlineTime) {
                    // Add badge
                    const mark = li.querySelector(".overdueMark");
                    mark.innerHTML = `<span class="overdue-badge">Overdue</span>`;

                    // Deduct point ONLY once
                    if (!li.dataset.deducted) {
                        completedMissions = Math.max(0, completedMissions - 1);
                        li.dataset.deducted = "true"; // prevent future deductions
                        document.getElementById("missionCounter").textContent = completedMissions;
                        saveData();
                    }
                }
            });
        }


        setInterval(checkMissedDeadlines, 60000); // check every 1 minute

        function updateMission() {
            const li = window.missionBeingEdited;
            if (!li) return;

            const newText = document.getElementById("editMissionInput").value;
            const newDeadline = document.getElementById("editMissionDeadline").value;

            // Update text
            li.querySelector(".mission-text").textContent = newText;

            // Update deadline
            if (newDeadline) {
                const d = new Date(newDeadline);
                const dateString = d.toLocaleDateString([], { day: "numeric", month: "short" });
                const timeString = d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });

                li.querySelector(".deadlineDisplay").textContent = `${dateString}, ${timeString}`;
            } else {
                li.querySelector(".deadlineDisplay").textContent = "";
            }

            // REMOVE overdue badge when mission is updated
            li.querySelector(".overdueMark").innerHTML = "";

            // REMOVE deducted flag so new deadline can deduct again if late
            delete li.dataset.deducted;

            saveData();
            closeModal();
        }

        function deleteMission() {
            const li = window.missionBeingEdited;
            if (!li) return;

            li.remove();
            saveData();
            closeModal();
        }


        function completeMission(btn) {
            const li = btn.parentElement;

            const isOverdue = li.querySelector(".overdueMark").innerHTML.trim() !== "";

            // Animation
            li.classList.add("remove");
            setTimeout(() => li.remove(), 400);

            // Add point only if NOT overdue
            if (!isOverdue) {
                completedMissions++;
            }

            document.getElementById("missionCounter").textContent = completedMissions;

            checkMissionAchievements();
            showPopup(isOverdue ? "Mission completed (overdue, no points added)" : "You completed a mission! Keep it up!");

            saveData();
        }


        function checkMissionAchievements() {
            missionMilestones.forEach(m => {
                if (completedMissions === m) unlockAchievement("mission" + m);
            });
        }

        function showPopup(achievementText) {
            const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];

            document.getElementById("motivationQuote").innerText = randomQuote;
            document.getElementById("achievement").innerText = achievementText;

            const popup = document.getElementById("motivationPopup");
            popup.style.display = "flex";

            if (!window.isAchievementPlaying) {
                const sound = document.getElementById("popupSound");
                sound.currentTime = 0;
                sound.volume = 1.0;
                sound.play().catch(() => { });
            }
        }

        function closePopup() {
            const popup = document.getElementById("motivationPopup");
            const content = popup.querySelector(".popup-content");

            content.style.animation = "fadeOut 0.3s ease forwards";

            setTimeout(() => {
                popup.style.display = "none";
                content.style.animation = "popIn 0.4s ease forwards";
            }, 300);
        }


        /* =========================================================
           6. SKILLS MODULE
        ========================================================= */
        function addSkill() {
            const skill = document.getElementById("skillInput").value;
            let progress = document.getElementById("progressInput").value;

            if (skill && progress !== "") {
                progress = Math.min(100, Math.max(0, parseInt(progress)));

                const div = document.createElement("div");
                div.className = "skill";
                div.innerHTML = `
      <strong>${skill}</strong>
      <div class="progress"><div class="progress-bar" style="width:${progress}%"></div></div>
    `;

                div.addEventListener("click", () => openModal("edit-skill", div));

                setTimeout(() => div.classList.add("show"), 10);
                document.getElementById("skill-list").appendChild(div);
                saveData();
            }

            closeModal();
        }

        function updateSkillProgress(skillName) {
            let newProgress = document.getElementById("editProgressInput").value;
            newProgress = Math.min(100, Math.max(0, parseInt(newProgress)));

            const skills = document.querySelectorAll("#skill-list .skill");
            skills.forEach(skill => {
                if (skill.querySelector("strong").textContent === skillName) {
                    skill.querySelector(".progress-bar").style.width = newProgress + "%";
                }
            });

            saveData();
            closeModal();
        }

        function deleteSkill(skillName) {
            const skills = document.querySelectorAll("#skill-list .skill");
            skills.forEach(skill => {
                if (skill.querySelector("strong").textContent === skillName) skill.remove();
            });

            saveData();
            closeModal();
        }


        /* =========================================================
           7. GOALS MODULE
        ========================================================= */
        function addGoal() {
            const goal = document.getElementById("goalInput").value;
            const priority = document.getElementById("priorityInput").value;
            const deadline = document.getElementById("goalDeadline").value;

            if (goal) {
                const div = document.createElement("div");
                div.className = "goal show";
                div.dataset.deadline = deadline;

                // Format deadline compactly
                let formattedDeadline = "";
                if (deadline) {
                    const d = new Date(deadline);
                    const dateString = d.toLocaleDateString([], { day: 'numeric', month: 'short' });
                    // const timeString = d.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    formattedDeadline = `${dateString}`;
                }

                div.innerHTML = `
      <div class="goal-header">
        <span class="goal-title">${goal}</span>
        <span class="goal-priority ${priority}">-<strong> ${priority}</strong></span>
      </div>

      <div class="goal-subrow">
        <span class="goal-deadline">${formattedDeadline}</span>
        <button class="remove-btn" onclick="removeGoal(this)" style="margin: 0px 30px 0px 0px">Remove</button>
      </div>


    `;

                document.getElementById("goal-list").appendChild(div);
                saveData();
            }

            closeModal();
        }



        function updateGoalTimers() {
            const goals = document.querySelectorAll("#goal-list .goal");
            const now = new Date().getTime();

            goals.forEach(goal => {
                const deadline = goal.dataset.deadline;
                const timer = goal.querySelector(".goal-timer");
                const overdueMark = goal.querySelector(".goal-overdue");

                if (!deadline || !timer) return;

                const target = new Date(deadline).getTime();
                const diff = target - now;

                // OVERDUE
                if (diff <= 0) {
                    timer.textContent = "Time's up!";
                    timer.style.color = "red";
                    overdueMark.innerHTML = `<span class="overdue-badge">Overdue</span>`;
                    return;
                }

                // REMOVE overdue if user updated it
                overdueMark.innerHTML = "";

                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const secs = Math.floor((diff % (1000 * 60)) / 1000);

                timer.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;

                // Color rules
                if (diff > 24 * 60 * 60 * 1000) {
                    timer.style.color = "white";
                } else if (diff > 60 * 60 * 1000) {
                    timer.style.color = "yellow";
                } else if (diff > 10 * 60 * 1000) {
                    timer.style.color = "orange";
                } else {
                    timer.style.color = "red";
                }
            });
        }
        setInterval(updateGoalTimers, 1000);


        function removeGoal(btn) {
            const goalDiv = btn.closest(".goal");
            if (goalDiv) {
                goalDiv.remove();
                saveData();
            }
        }


        /* =========================================================
           8. COUNTDOWNS MODULE
        ========================================================= */
        let countdowns = JSON.parse(localStorage.getItem("countdowns")) || [];

        function saveCountdowns() {
            localStorage.setItem("countdowns", JSON.stringify(countdowns));
        }

        function addCountdown() {
            const title = document.getElementById("countdownTitle").value;
            const dateTime = document.getElementById("countdownDateTime").value;

            if (title && dateTime) {
                countdowns.push({
                    title,
                    date: new Date(dateTime).toISOString(),
                    startTime: new Date().toISOString()
                });


                saveCountdowns();
                renderCountdowns();
            }

            closeModal();
        }



        function removeCountdown(index) {
            countdowns.splice(index, 1);
            saveCountdowns();
            renderCountdowns();
        }

        function renderCountdowns() {
            const list = document.getElementById("countdown-list");
            list.innerHTML = "";

            document.getElementById("countdownCounter").textContent = countdowns.length;

            if (countdowns.length === 0) {
                list.textContent = "No countdowns added";
                return;
            }

            countdowns.forEach((c, index) => {
                const div = document.createElement("div");
                div.className = "goal show";

                div.innerHTML = `
      <strong>${c.title}</strong>
      <div class="timer-row">
  <div class="timer-bar-container">
    <div class="timer-bar" id="timerbar-${index}"></div>
  </div>
  <div class="timer-text" id="timer-${index}"></div>
</div>
      <button class="remove-btn2" onclick="removeCountdown(${index})">Remove</button>
    `;

                list.appendChild(div);
            });

            updateTimers();
        }


        function updateTimers() {
            clearInterval(window.timerInterval);

            window.timerInterval = setInterval(() => {
                countdowns.forEach((c, index) => {
                    const now = new Date().getTime();
                    const target = new Date(c.date).getTime();
                    const diff = target - now;

                    const totalDuration = target - new Date(countdowns[index].startTime || c.date).getTime();
                    const remaining = diff;

                    let percent = (remaining / totalDuration) * 100;

                    // clamp values
                    if (percent < 0) percent = 0;
                    if (percent > 100) percent = 100;

                    const bar = document.getElementById(`timerbar-${index}`);
                    if (bar) bar.style.width = percent + "%";



                    const el = document.getElementById(`timer-${index}`);
                    if (!el) return;

                    if (diff <= 0) {
                        el.style.color = "red";
                        el.textContent = "Time's up!";
                        return;
                    }

                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const secs = Math.floor((diff % (1000 * 60)) / 1000);

                    el.textContent = `${days}d ${hours}h ${mins}m ${secs}s`;
                });
            }, 1000);
        }




        /* =========================================================
           9. RESET & DATA MANAGEMENT
        ========================================================= */
        function saveData() {
            localStorage.setItem("completedMissions", completedMissions);
            localStorage.setItem("missionHistory", JSON.stringify(missionHistory));
            localStorage.setItem("missions", document.getElementById("mission-list").innerHTML);
            localStorage.setItem("skills", document.getElementById("skill-list").innerHTML);
            localStorage.setItem("goals", document.getElementById("goal-list").innerHTML);
        }

        function loadData() {
            document.getElementById("mission-list").innerHTML =
                localStorage.getItem("missions") || "";
            document.getElementById("skill-list").innerHTML =
                localStorage.getItem("skills") || "";
            document.getElementById("goal-list").innerHTML =
                localStorage.getItem("goals") || "";

            document.querySelectorAll("#skill-list .skill").forEach(div => {
                div.addEventListener("click", () => openModal("edit-skill", div));
                div.classList.add("show");
            });

            document.querySelectorAll("#goal-list .goal").forEach(div => {
                div.classList.add("show");
                const removeBtn = div.querySelector(".remove-btn");
                if (removeBtn) {
                    removeBtn.onclick = () => removeGoal(removeBtn);
                }
            });
        }

        function resetData() {
            localStorage.clear();

            document.getElementById("skill-list").innerHTML = "";
            document.getElementById("goal-list").innerHTML = "";
            document.getElementById("mission-list").innerHTML = "";

            completedMissions = 0;
            missionHistory = {};
            document.getElementById("missionCounter").textContent = "0";

            clearInterval(window.timerInterval);
            countdowns = [];
            saveCountdowns();
            renderCountdowns();

            achievementsData = achievements.map(a => ({ ...a, unlocked: false }));
            localStorage.setItem("achievements", JSON.stringify(achievementsData));
            renderAchievements();

            customAlert("All data has been reset");
        }


        /* =========================================================
           10. INITIALIZATION
        ========================================================= */
        window.addEventListener("load", () => {
            renderAchievements();
            renderCountdowns();
            loadData();

            const activePage = document.querySelector("section.active")
                ? document.querySelector("section.active").id
                : "missions";

            showPage(activePage);
        });

        document.querySelectorAll("#goal-list .goal").forEach(div => {
            div.classList.add("show");
            const removeBtn = div.querySelector(".remove-btn");
            if (removeBtn) {
                removeBtn.onclick = () => removeGoal(removeBtn);
            }
        });


    </script>

</body>

</html>
